<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Test WP2 class &mdash; elwaspatid 2.0.0 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Compare ElasticImpact and WP2" href="plot_2_ElasticImpact.html" />
    <link rel="prev" title="Test Waveprop class" href="plot_0_Waveprop.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> elwaspatid
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples of diagrams</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_0_Waveprop.html">Test <code class="xref py py-class docutils literal notranslate"><span class="pre">Waveprop</span></code> class</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Test <code class="xref py py-class docutils literal notranslate"><span class="pre">WP2</span></code> class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#two-identical-bars-free-ends">Two identical bars, free-ends</a></li>
<li class="toctree-l3"><a class="reference internal" href="#two-identical-bars-free-and-fixed-ends">Two identical bars, free and fixed ends</a></li>
<li class="toctree-l3"><a class="reference internal" href="#two-different-bars-infinite-ends">Two different bars, infinite-ends</a></li>
<li class="toctree-l3"><a class="reference internal" href="#two-identical-bars-with-traction-pulse">Two identical bars with traction pulse</a></li>
<li class="toctree-l3"><a class="reference internal" href="#two-bars-cross-section-increase">Two bars, cross-section increase</a></li>
<li class="toctree-l3"><a class="reference internal" href="#two-bars-cross-section-reduction">Two bars, cross-section reduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#first-bar-with-initial-velocity">First bar with initial velocity</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#positive-velocity-compression">Positive velocity: compression</a></li>
<li class="toctree-l4"><a class="reference internal" href="#negative-velocity">Negative velocity</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_2_ElasticImpact.html">Compare <code class="xref py py-class docutils literal notranslate"><span class="pre">ElasticImpact</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">WP2</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_3_deSaintVenant.html">De Saint Venant displacement diagrams</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_4_SHPB.html">Use <code class="xref py py-class docutils literal notranslate"><span class="pre">Waveprop</span></code> to simulate SHPB test</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_5_contactLoss.html">Displacement and contact loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_6_underHood.html">Under the hood</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">elwaspatid</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Examples of diagrams</a> &raquo;</li>
      <li>Test <code class="xref py py-class docutils literal notranslate"><span class="pre">WP2</span></code> class</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/auto_examples/plot_1_WP2.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-plot-1-wp2-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="test-wp2-class">
<span id="sphx-glr-auto-examples-plot-1-wp2-py"></span><h1>Test <code class="xref py py-class docutils literal notranslate"><span class="pre">WP2</span></code> class<a class="headerlink" href="#test-wp2-class" title="Permalink to this headline"></a></h1>
<p>Define a <code class="xref py py-class docutils literal notranslate"><span class="pre">BarSet</span></code> bar configuration and use it with <code class="xref py py-class docutils literal notranslate"><span class="pre">WP2</span></code> to compute
elastic wave propagation in simple test cases.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">elwaspatid</span> <span class="kn">import</span> <span class="n">WP2</span><span class="p">,</span> <span class="n">BarSet</span>
</pre></div>
</div>
<p>Define a few parameters</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> <span class="mf">201e9</span>  <span class="c1"># Young modulus [Pa]</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mi">7800</span>  <span class="c1"># Density [kg/m3]</span>
<span class="n">d</span> <span class="o">=</span> <span class="mf">0.020</span>  <span class="c1"># diameter [m]</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">2.4</span>  <span class="c1"># diameters ratio [-]</span>
</pre></div>
</div>
<p>Create the bar configurations: two bars in contact.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nm</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">bc</span> <span class="o">=</span> <span class="n">BarSet</span><span class="p">([</span><span class="n">E</span><span class="p">,</span> <span class="n">E</span><span class="p">],</span> <span class="p">[</span><span class="n">rho</span><span class="p">,</span> <span class="n">rho</span><span class="p">],</span> <span class="p">[</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.13</span><span class="p">],</span> <span class="p">[</span><span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">],</span> <span class="n">nmin</span><span class="o">=</span><span class="n">nm</span><span class="p">)</span>  <span class="c1"># same section</span>
<span class="n">bc2</span> <span class="o">=</span> <span class="n">BarSet</span><span class="p">([</span><span class="n">E</span><span class="p">,</span> <span class="n">E</span><span class="p">],</span> <span class="p">[</span><span class="n">rho</span><span class="p">,</span> <span class="n">rho</span><span class="p">],</span> <span class="p">[</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.13</span><span class="p">],</span> <span class="p">[</span><span class="n">d</span><span class="p">,</span> <span class="n">k</span><span class="o">*</span><span class="n">d</span><span class="p">],</span> <span class="n">nmin</span><span class="o">=</span><span class="n">nm</span><span class="p">)</span>  <span class="c1"># section increase</span>
<span class="n">bc3</span> <span class="o">=</span> <span class="n">BarSet</span><span class="p">([</span><span class="n">E</span><span class="p">,</span> <span class="n">E</span><span class="p">],</span> <span class="p">[</span><span class="n">rho</span><span class="p">,</span> <span class="n">rho</span><span class="p">],</span> <span class="p">[</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.13</span><span class="p">],</span> <span class="p">[</span><span class="n">k</span><span class="o">*</span><span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">],</span> <span class="n">nmin</span><span class="o">=</span><span class="n">nm</span><span class="p">)</span>  <span class="c1"># section reduction</span>
<span class="n">bc4</span> <span class="o">=</span> <span class="n">BarSet</span><span class="p">([</span><span class="n">E</span><span class="p">,</span> <span class="n">E</span><span class="p">],</span> <span class="p">[</span><span class="n">rho</span><span class="p">,</span> <span class="n">rho</span><span class="p">],</span> <span class="p">[</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.3</span><span class="p">],</span> <span class="p">[</span><span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">],</span> <span class="n">nmin</span><span class="o">=</span><span class="n">nm</span><span class="p">)</span>  <span class="c1"># same section</span>
</pre></div>
</div>
<p>Define the incident wave vector</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">comp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>  <span class="c1"># incident wave</span>
<span class="c1">#comp[0:20] = -1e3  # heavyside, compression (&lt;0)</span>
<span class="n">comp</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2e3</span>
<span class="n">comp</span><span class="p">[</span><span class="mi">15</span><span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1e3</span>
</pre></div>
</div>
<div class="section" id="two-identical-bars-free-ends">
<h2>Two identical bars, free-ends<a class="headerlink" href="#two-identical-bars-free-ends" title="Permalink to this headline"></a></h2>
<p>Contact interface between the two bars:</p>
<ol class="arabic simple">
<li><p>compression pulses cross the interface,</p></li>
<li><p>are reflected as traction pulses on the free end (right),</p></li>
<li><p>and traction is then reflected as compression on the contact interface,
as if this was a free end.</p></li>
</ol>
<p>And so on. Which means the pulse is trapped in the second bar.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test2</span> <span class="o">=</span> <span class="n">WP2</span><span class="p">(</span><span class="n">bc</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">nstep</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="s1">&#39;free&#39;</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="s1">&#39;free&#39;</span><span class="p">)</span>
<span class="n">test2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;2b_free&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_plot_1_WP2_001.png" srcset="../_images/sphx_glr_plot_1_WP2_001.png" alt="Force [N]" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_1_WP2_002.png" srcset="../_images/sphx_glr_plot_1_WP2_002.png" alt="Velocity [m/s]" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_1_WP2_003.png" srcset="../_images/sphx_glr_plot_1_WP2_003.png" alt="Displacement [m]" class = "sphx-glr-multi-img"/></li>
</ul>
</div>
<div class="section" id="two-identical-bars-free-and-fixed-ends">
<h2>Two identical bars, free and fixed ends<a class="headerlink" href="#two-identical-bars-free-and-fixed-ends" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test2</span> <span class="o">=</span> <span class="n">WP2</span><span class="p">(</span><span class="n">bc</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">nstep</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="s1">&#39;free&#39;</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">)</span>
<span class="n">test2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;2b_freefixed&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_plot_1_WP2_004.png" srcset="../_images/sphx_glr_plot_1_WP2_004.png" alt="Force [N]" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_1_WP2_005.png" srcset="../_images/sphx_glr_plot_1_WP2_005.png" alt="Velocity [m/s]" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_1_WP2_006.png" srcset="../_images/sphx_glr_plot_1_WP2_006.png" alt="Displacement [m]" class = "sphx-glr-multi-img"/></li>
</ul>
</div>
<div class="section" id="two-different-bars-infinite-ends">
<h2>Two different bars, infinite-ends<a class="headerlink" href="#two-different-bars-infinite-ends" title="Permalink to this headline"></a></h2>
<p>Compression pulses cross the interface and are partly reflected because of the
difference of impedance between the bars. At both end, no reflection occur
since infinite ends amounts to anechoic condition.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test2f</span> <span class="o">=</span> <span class="n">WP2</span><span class="p">(</span><span class="n">bc3</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">nstep</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="s1">&#39;infinite&#39;</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="s1">&#39;infinite&#39;</span><span class="p">)</span>
<span class="n">test2f</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;2b_anech&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_plot_1_WP2_007.png" srcset="../_images/sphx_glr_plot_1_WP2_007.png" alt="Force [N]" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_1_WP2_008.png" srcset="../_images/sphx_glr_plot_1_WP2_008.png" alt="Velocity [m/s]" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_1_WP2_009.png" srcset="../_images/sphx_glr_plot_1_WP2_009.png" alt="Displacement [m]" class = "sphx-glr-multi-img"/></li>
</ul>
</div>
<div class="section" id="two-identical-bars-with-traction-pulse">
<h2>Two identical bars with traction pulse<a class="headerlink" href="#two-identical-bars-with-traction-pulse" title="Permalink to this headline"></a></h2>
<p>The traction pulses do not cross the contact interface. The pulse is trapped
in the firt bar.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test2t</span> <span class="o">=</span> <span class="n">WP2</span><span class="p">(</span><span class="n">bc</span><span class="p">,</span> <span class="o">-</span><span class="n">comp</span><span class="p">,</span> <span class="n">nstep</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="s1">&#39;free&#39;</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="s1">&#39;free&#39;</span><span class="p">)</span>
<span class="n">test2t</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;2b_trac&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_plot_1_WP2_010.png" srcset="../_images/sphx_glr_plot_1_WP2_010.png" alt="Force [N]" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_1_WP2_011.png" srcset="../_images/sphx_glr_plot_1_WP2_011.png" alt="Velocity [m/s]" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_1_WP2_012.png" srcset="../_images/sphx_glr_plot_1_WP2_012.png" alt="Displacement [m]" class = "sphx-glr-multi-img"/></li>
</ul>
</div>
<div class="section" id="two-bars-cross-section-increase">
<h2>Two bars, cross-section increase<a class="headerlink" href="#two-bars-cross-section-increase" title="Permalink to this headline"></a></h2>
<p>Compression is reflected as traction.
Recall that the limit case of cross-section increase is the fixed end.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test2a</span> <span class="o">=</span> <span class="n">WP2</span><span class="p">(</span><span class="n">bc2</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">nstep</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="s1">&#39;free&#39;</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="s1">&#39;free&#39;</span><span class="p">)</span>
<span class="n">test2a</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;2b_incre&#39;</span><span class="p">)</span>
<span class="c1"># test2av = WP2(bc2, comp, nstep=100, left=&#39;free&#39;, right=&#39;free&#39;, Vinit=10)</span>
<span class="c1"># test2av.plot(&#39;2baugmv&#39;)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_plot_1_WP2_013.png" srcset="../_images/sphx_glr_plot_1_WP2_013.png" alt="Force [N]" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_1_WP2_014.png" srcset="../_images/sphx_glr_plot_1_WP2_014.png" alt="Velocity [m/s]" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_1_WP2_015.png" srcset="../_images/sphx_glr_plot_1_WP2_015.png" alt="Displacement [m]" class = "sphx-glr-multi-img"/></li>
</ul>
</div>
<div class="section" id="two-bars-cross-section-reduction">
<h2>Two bars, cross-section reduction<a class="headerlink" href="#two-bars-cross-section-reduction" title="Permalink to this headline"></a></h2>
<p>Compression is reflected as compression
Recall that the limit case of cross-section reduction is the free end.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test2d</span> <span class="o">=</span> <span class="n">WP2</span><span class="p">(</span><span class="n">bc3</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">nstep</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="s1">&#39;free&#39;</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="s1">&#39;free&#39;</span><span class="p">)</span>
<span class="n">test2d</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;2b_reduc&#39;</span><span class="p">)</span>
<span class="c1"># test2dv = WP2(bc3, comp, nstep=100, left=&#39;free&#39;, right=&#39;free&#39;, Vinit=10)</span>
<span class="c1"># test2dv.plot(&#39;2bdimiv&#39;)</span>
<span class="n">test2d</span><span class="o">.</span><span class="n">plotInterface</span><span class="p">(</span><span class="n">figname</span><span class="o">=</span><span class="s1">&#39;interf&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_plot_1_WP2_016.png" srcset="../_images/sphx_glr_plot_1_WP2_016.png" alt="Force [N]" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_1_WP2_017.png" srcset="../_images/sphx_glr_plot_1_WP2_017.png" alt="Velocity [m/s]" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_1_WP2_018.png" srcset="../_images/sphx_glr_plot_1_WP2_018.png" alt="Displacement [m]" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_1_WP2_019.png" srcset="../_images/sphx_glr_plot_1_WP2_019.png" alt="x = 0 m" class = "sphx-glr-multi-img"/></li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/dbrizard/Miscellaneous/prop1d/src/elwaspatid/elwaspatid.py:395: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  ax1 = plt.subplot(nsbp, 1, 1)
/home/dbrizard/Miscellaneous/prop1d/src/elwaspatid/elwaspatid.py:402: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(nsbp, 1, 2, sharex=ax1)
/home/dbrizard/Miscellaneous/prop1d/src/elwaspatid/elwaspatid.py:409: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(nsbp, 1, 3, sharex=ax1)
</pre></div>
</div>
</div>
<div class="section" id="first-bar-with-initial-velocity">
<h2>First bar with initial velocity<a class="headerlink" href="#first-bar-with-initial-velocity" title="Permalink to this headline"></a></h2>
<div class="section" id="positive-velocity-compression">
<h3>Positive velocity: compression<a class="headerlink" href="#positive-velocity-compression" title="Permalink to this headline"></a></h3>
<p>As the first bar (=stricker) impacts the second bar, a compression pulse
develops in both bars. The stricker being shorter that the second bar, the
compression pulse reaches the left end of the stricker and is reflected as
traction with the same magnitude as the compression pulse: traction cancels
compression and the force is null (traction can be considered as an unloading
wave).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test2v</span> <span class="o">=</span> <span class="n">WP2</span><span class="p">(</span><span class="n">bc4</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">nstep</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="s1">&#39;free&#39;</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="s1">&#39;free&#39;</span><span class="p">,</span> <span class="n">Vinit</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">test2v</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;2b_veloc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_plot_1_WP2_020.png" srcset="../_images/sphx_glr_plot_1_WP2_020.png" alt="Force [N]" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_1_WP2_021.png" srcset="../_images/sphx_glr_plot_1_WP2_021.png" alt="Velocity [m/s]" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_1_WP2_022.png" srcset="../_images/sphx_glr_plot_1_WP2_022.png" alt="Displacement [m]" class = "sphx-glr-multi-img"/></li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Setting initial velocity of first segment (Vo=10)
</pre></div>
</div>
</div>
<div class="section" id="negative-velocity">
<h3>Negative velocity<a class="headerlink" href="#negative-velocity" title="Permalink to this headline"></a></h3>
<p>Nothing happens, the left bar travels to the left.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test2vn</span> <span class="o">=</span> <span class="n">WP2</span><span class="p">(</span><span class="n">bc4</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">nstep</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="s1">&#39;free&#39;</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="s1">&#39;free&#39;</span><span class="p">,</span> <span class="n">Vinit</span><span class="o">=-</span><span class="mi">10</span><span class="p">)</span>
<span class="n">test2vn</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;2b_negveloc&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_plot_1_WP2_023.png" srcset="../_images/sphx_glr_plot_1_WP2_023.png" alt="Force [N]" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_1_WP2_024.png" srcset="../_images/sphx_glr_plot_1_WP2_024.png" alt="Velocity [m/s]" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_1_WP2_025.png" srcset="../_images/sphx_glr_plot_1_WP2_025.png" alt="Displacement [m]" class = "sphx-glr-multi-img"/></li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Setting initial velocity of first segment (Vo=-10)
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  9.025 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-1-wp2-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/5f21cda0014220bcc082ded82c151748/plot_1_WP2.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_1_WP2.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/a1e08f0cb7970879e0b1bd1553fe6f9d/plot_1_WP2.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_1_WP2.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="plot_0_Waveprop.html" class="btn btn-neutral float-left" title="Test Waveprop class" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="plot_2_ElasticImpact.html" class="btn btn-neutral float-right" title="Compare ElasticImpact and WP2" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Denis Brizard.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>